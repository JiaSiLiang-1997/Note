# redis哨兵集群相关问题（怎么主从同步，怎么哨兵选举， 怎么master选举）

# 为什么要使用哨兵模式？

在主从结构中，主机宕机后（没有写服务，只有读服务），通过哨兵，选取新的master

![image-20220227150526171](https://jsl1997.oss-cn-beijing.aliyuncs.com/note/image-20220227150526171.png)

![image-20220227150636585](https://jsl1997.oss-cn-beijing.aliyuncs.com/note/image-20220227150636585.png)

大概流程：

- 将宕机的master下线；
- 找一个slave作为master；
- 通知所有的slave连接新的master；
- 启动新的master与slvae；
- 全量复制* N + 部分复制 *N

# 谁来确认master宕机了？

**哨兵**：哨兵(sentinel)是一个分布式系统， 于对主从结构中的每台服务器进行监控，当出现故障时通过**投票机制**选择新的master并将所有slave连接到新的master。

![image-20220227154935578](https://jsl1997.oss-cn-beijing.aliyuncs.com/note/image-20220227154935578.png)







# 找一个主？怎么找？（master怎么选举）









# 通知修改配置后，原始的主恢复了怎么办？









